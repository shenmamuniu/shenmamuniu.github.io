{"title":"c# networkStream运行一段时候后连接丢失","slug":"128","date":"2022-06-21T06:30:53.000Z","updated":"2022-06-21T06:30:53.000Z","comments":true,"path":"api/articles/128.json","excerpt":"c# 在使用接收tcpserver中的数据时,经常运行一段时间后出现假死的状态，无法再接收数据，也没有报错信息，通过设置readTimeout来重新连接tcpserver实现数据的继续接收。","covers":null,"content":"<p>c# 在使用接收tcpserver中的数据时,经常运行一段时间后出现假死的状态，无法再接收数据，也没有报错信息，通过设置readTimeout来重新连接tcpserver实现数据的继续接收。</p>\n<span id=\"more\"></span>\n<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><p>应用环境：.net framework4.0<br>os:win10</p>\n<h2 id=\"设置ReadTimeout参数\"><a href=\"#设置ReadTimeout参数\" class=\"headerlink\" title=\"设置ReadTimeout参数\"></a>设置ReadTimeout参数</h2><p>在读取网络流中的数据时，总是运行10分钟后连接就丢失，无法读取到数据了，可通过设置ReadTimeout参数，在指定的时间内如果读取不到网络流时,会报如下错误：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">无法从传输连接中读取数据: 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>此时进入异常处理函数中，重新连接即可。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">try&#123;\n    tcpClient &#x3D; new TcpClient();\n    tcpClient.Connect(System.Net.IPAddress.Parse(this.ip), this.port);\n    networkStream &#x3D; tcpClient.GetStream();\n    networkStream.ReadTimeout &#x3D; 10000;\n&#125;\ncatch(Exception ex)&#123;\n    &#x2F;&#x2F;重新连接逻辑代码\n&#125;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"Referenced\"><a href=\"#Referenced\" class=\"headerlink\" title=\"Referenced\"></a>Referenced</h2><p><a href=\"https://blog.csdn.net/v6543210/article/details/85016784\">1、C# 中NetworkStream类Read函数导致程序死机的问题</a><br><a href=\"https://huadou145.lofter.com/post/205d4db3_1c8a36320\">2、封面图源</a></p>\n","more":"<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><p>应用环境：.net framework4.0<br>os:win10</p>\n<h2 id=\"设置ReadTimeout参数\"><a href=\"#设置ReadTimeout参数\" class=\"headerlink\" title=\"设置ReadTimeout参数\"></a>设置ReadTimeout参数</h2><p>在读取网络流中的数据时，总是运行10分钟后连接就丢失，无法读取到数据了，可通过设置ReadTimeout参数，在指定的时间内如果读取不到网络流时,会报如下错误：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">无法从传输连接中读取数据: 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>此时进入异常处理函数中，重新连接即可。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">try&#123;\n    tcpClient &#x3D; new TcpClient();\n    tcpClient.Connect(System.Net.IPAddress.Parse(this.ip), this.port);\n    networkStream &#x3D; tcpClient.GetStream();\n    networkStream.ReadTimeout &#x3D; 10000;\n&#125;\ncatch(Exception ex)&#123;\n    &#x2F;&#x2F;重新连接逻辑代码\n&#125;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"Referenced\"><a href=\"#Referenced\" class=\"headerlink\" title=\"Referenced\"></a>Referenced</h2><p><a href=\"https://blog.csdn.net/v6543210/article/details/85016784\">1、C# 中NetworkStream类Read函数导致程序死机的问题</a><br><a href=\"https://huadou145.lofter.com/post/205d4db3_1c8a36320\">2、封面图源</a></p>","categories":[{"name":"语言","path":"api/categories/语言.json"}],"tags":[{"name":"C","path":"api/tags/C.json"}]}