{"title":"ArcMap水文分析-提取河网和流域","slug":"82","date":"2021-03-11T08:21:00.000Z","updated":"2021-03-11T08:27:52.000Z","comments":true,"path":"api/articles/82.json","realPath":null,"excerpt":"本文记录了使用ArcMap对DEM数据进行水文分析，提取河网和流域的过程，对栅格和矢量数据的切割也略有涉及。","covers":null,"cover":null,"content":"<p>本文记录了使用ArcMap对DEM数据进行水文分析，提取河网和流域的过程，对栅格和矢量数据的切割也略有涉及。</p>\n<span id=\"more\"></span>\n<h2 id=\"运行环境\"><a href=\"#运行环境\" class=\"headerlink\" title=\"运行环境\"></a>运行环境</h2><p>ArcGIS:10.2<br>OS:Win10 x64</p>\n<h2 id=\"数据预处理\"><a href=\"#数据预处理\" class=\"headerlink\" title=\"数据预处理\"></a>数据预处理</h2><p>原始数据是从地理空间数据云中下载到的30m dem<br>水文分析不支持个人地理数据库</p>\n<h3 id=\"DEM数据切割-Optional\"><a href=\"#DEM数据切割-Optional\" class=\"headerlink\" title=\"DEM数据切割(Optional)\"></a>DEM数据切割(Optional)</h3><p>Spatial Analyst Tools-&gt;Extraction-&gt;Extract By mask</p>\n<h3 id=\"对DEM数据进行拼接-Optional\"><a href=\"#对DEM数据进行拼接-Optional\" class=\"headerlink\" title=\"对DEM数据进行拼接(Optional)\"></a>对DEM数据进行拼接(Optional)</h3><p>Data Management tools-&gt;Raster-&gt;Raster Dataset-&gt;Mosaic</p>\n<h3 id=\"为栅格数据创建属性表-Optional\"><a href=\"#为栅格数据创建属性表-Optional\" class=\"headerlink\" title=\"为栅格数据创建属性表(Optional)\"></a>为栅格数据创建属性表(Optional)</h3><p>Data Management tools-&gt;Raster-&gt;Raster Properties-&gt;Build Raster Attribute Table<br><strong>提示：</strong>在进行水文分析时，如果中途生成的栅格数据没有属性表，后续操作可能会有NoData的错误，如果遇到，可以创建属性表。</p>\n<h2 id=\"DEM填坑\"><a href=\"#DEM填坑\" class=\"headerlink\" title=\"DEM填坑\"></a>DEM填坑</h2><p>Spatial Analyst Tools——&gt;Hydrology-&gt;Flow Direction<br>处理结果如果是黑白的1-255的,那么说明DEM数据需要进行填坑处理，否则进行下一步</p>\n<h3 id=\"sink\"><a href=\"#sink\" class=\"headerlink\" title=\"sink\"></a>sink</h3><p>输入：flowdir<br>结果：sink</p>\n<h3 id=\"watershed\"><a href=\"#watershed\" class=\"headerlink\" title=\"watershed\"></a>watershed</h3><p>输入：</p>\n<pre><code>input flow direction raster:flowdir\n\ninput raster or feature pour point data:sink\n</code></pre>\n<p>结果：sinkshed</p>\n<p>这一步是通过watershed工具推算出哪些区域的水会流到这些坑里</p>\n<h3 id=\"zonal-statistics\"><a href=\"#zonal-statistics\" class=\"headerlink\" title=\"zonal statistics\"></a>zonal statistics</h3><p>输入：</p>\n<p>input raster or feature zone data: sinkshed</p>\n<p>zone field: Value</p>\n<p>Input value raster: dem</p>\n<p>statistics type: minimum</p>\n<p>输出：sink_min</p>\n<p>通过区域统计得到“坑”的流域内高程的最低值</p>\n<h3 id=\"zonal-fill\"><a href=\"#zonal-fill\" class=\"headerlink\" title=\"zonal fill\"></a>zonal fill</h3><p>输入：</p>\n<p>input zone raster:sinkshed</p>\n<p>input weight raster:dem</p>\n<p>输出：</p>\n<p>sink_max</p>\n<p>使用区域填充的结果是沿着“坑”流域的边界，也就是分水岭，把整个流域填平。这样就获得了“坑”流域的最高高程</p>\n<h3 id=\"raster-calculator\"><a href=\"#raster-calculator\" class=\"headerlink\" title=\"raster calculator\"></a>raster calculator</h3><p>输入：</p>\n<p>sink_max - sink_min</p>\n<p>输出：</p>\n<p>sink_depth</p>\n<p>这步没什么好说的，大值减小值得到“坑”的最大深度</p>\n<h3 id=\"fill\"><a href=\"#fill\" class=\"headerlink\" title=\"fill\"></a>fill</h3><p>输入：</p>\n<p>input surface raster: dem</p>\n<p>Z limit: sink_depth(max)</p>\n<p>输出：filldem</p>\n<p>Z limit中要填sink_depth中的上限值，我这里就是510。</p>\n<h3 id=\"flow-direction\"><a href=\"#flow-direction\" class=\"headerlink\" title=\"flow direction\"></a>flow direction</h3><p>输入：filldem</p>\n<p>输出：fill_dir</p>\n<p>如果这次的输出和之前一样，那么请重新开始填坑。</p>\n<h2 id=\"计算径流量\"><a href=\"#计算径流量\" class=\"headerlink\" title=\"计算径流量\"></a>计算径流量</h2><p>flow accumulation<br>输入：fill_dir</p>\n<p>输出：accu</p>\n<h2 id=\"提取河网\"><a href=\"#提取河网\" class=\"headerlink\" title=\"提取河网\"></a>提取河网</h2><p>Spatial Analyst Tools-&gt;Map Algebra-&gt;Raster Calculator</p>\n<p>Con(accu&gt;X,1)<br>其中X为径流量，此值越大，河网越稀疏</p>\n<p>输出：河网</p>\n<h2 id=\"Stream-Link-amp-Stream-Order\"><a href=\"#Stream-Link-amp-Stream-Order\" class=\"headerlink\" title=\"Stream Link &amp;Stream Order\"></a>Stream Link &amp;Stream Order</h2><p>连接及分级</p>\n<h2 id=\"Stream-To-Feature\"><a href=\"#Stream-To-Feature\" class=\"headerlink\" title=\"Stream To Feature\"></a>Stream To Feature</h2><p>将河网转为Polyline<br>对河网分级设色：在矢量河网图层中的属性对话框中，Symbology-&gt;Quantities-&gt;Graduated colors.</p>\n<h2 id=\"流域提取\"><a href=\"#流域提取\" class=\"headerlink\" title=\"流域提取\"></a>流域提取</h2><p>使用watershed</p>\n<h2 id=\"Referenced\"><a href=\"#Referenced\" class=\"headerlink\" title=\"Referenced\"></a>Referenced</h2><p><a href=\"https://www.jianshu.com/p/371b81b3e24b\">1、简明Arcgis流域提取方法</a><br><a href=\"https://www.cnblogs.com/crazytao/p/8108829.html\">2、arcgis水文分析</a><br><a href=\"https://huadou145.lofter.com/post/205d4db3_1c81c6e8f\">3、封面图源</a></p>\n","more":"<h2 id=\"运行环境\"><a href=\"#运行环境\" class=\"headerlink\" title=\"运行环境\"></a>运行环境</h2><p>ArcGIS:10.2<br>OS:Win10 x64</p>\n<h2 id=\"数据预处理\"><a href=\"#数据预处理\" class=\"headerlink\" title=\"数据预处理\"></a>数据预处理</h2><p>原始数据是从地理空间数据云中下载到的30m dem<br>水文分析不支持个人地理数据库</p>\n<h3 id=\"DEM数据切割-Optional\"><a href=\"#DEM数据切割-Optional\" class=\"headerlink\" title=\"DEM数据切割(Optional)\"></a>DEM数据切割(Optional)</h3><p>Spatial Analyst Tools-&gt;Extraction-&gt;Extract By mask</p>\n<h3 id=\"对DEM数据进行拼接-Optional\"><a href=\"#对DEM数据进行拼接-Optional\" class=\"headerlink\" title=\"对DEM数据进行拼接(Optional)\"></a>对DEM数据进行拼接(Optional)</h3><p>Data Management tools-&gt;Raster-&gt;Raster Dataset-&gt;Mosaic</p>\n<h3 id=\"为栅格数据创建属性表-Optional\"><a href=\"#为栅格数据创建属性表-Optional\" class=\"headerlink\" title=\"为栅格数据创建属性表(Optional)\"></a>为栅格数据创建属性表(Optional)</h3><p>Data Management tools-&gt;Raster-&gt;Raster Properties-&gt;Build Raster Attribute Table<br><strong>提示：</strong>在进行水文分析时，如果中途生成的栅格数据没有属性表，后续操作可能会有NoData的错误，如果遇到，可以创建属性表。</p>\n<h2 id=\"DEM填坑\"><a href=\"#DEM填坑\" class=\"headerlink\" title=\"DEM填坑\"></a>DEM填坑</h2><p>Spatial Analyst Tools——&gt;Hydrology-&gt;Flow Direction<br>处理结果如果是黑白的1-255的,那么说明DEM数据需要进行填坑处理，否则进行下一步</p>\n<h3 id=\"sink\"><a href=\"#sink\" class=\"headerlink\" title=\"sink\"></a>sink</h3><p>输入：flowdir<br>结果：sink</p>\n<h3 id=\"watershed\"><a href=\"#watershed\" class=\"headerlink\" title=\"watershed\"></a>watershed</h3><p>输入：</p>\n<pre><code>input flow direction raster:flowdir\n\ninput raster or feature pour point data:sink\n</code></pre>\n<p>结果：sinkshed</p>\n<p>这一步是通过watershed工具推算出哪些区域的水会流到这些坑里</p>\n<h3 id=\"zonal-statistics\"><a href=\"#zonal-statistics\" class=\"headerlink\" title=\"zonal statistics\"></a>zonal statistics</h3><p>输入：</p>\n<p>input raster or feature zone data: sinkshed</p>\n<p>zone field: Value</p>\n<p>Input value raster: dem</p>\n<p>statistics type: minimum</p>\n<p>输出：sink_min</p>\n<p>通过区域统计得到“坑”的流域内高程的最低值</p>\n<h3 id=\"zonal-fill\"><a href=\"#zonal-fill\" class=\"headerlink\" title=\"zonal fill\"></a>zonal fill</h3><p>输入：</p>\n<p>input zone raster:sinkshed</p>\n<p>input weight raster:dem</p>\n<p>输出：</p>\n<p>sink_max</p>\n<p>使用区域填充的结果是沿着“坑”流域的边界，也就是分水岭，把整个流域填平。这样就获得了“坑”流域的最高高程</p>\n<h3 id=\"raster-calculator\"><a href=\"#raster-calculator\" class=\"headerlink\" title=\"raster calculator\"></a>raster calculator</h3><p>输入：</p>\n<p>sink_max - sink_min</p>\n<p>输出：</p>\n<p>sink_depth</p>\n<p>这步没什么好说的，大值减小值得到“坑”的最大深度</p>\n<h3 id=\"fill\"><a href=\"#fill\" class=\"headerlink\" title=\"fill\"></a>fill</h3><p>输入：</p>\n<p>input surface raster: dem</p>\n<p>Z limit: sink_depth(max)</p>\n<p>输出：filldem</p>\n<p>Z limit中要填sink_depth中的上限值，我这里就是510。</p>\n<h3 id=\"flow-direction\"><a href=\"#flow-direction\" class=\"headerlink\" title=\"flow direction\"></a>flow direction</h3><p>输入：filldem</p>\n<p>输出：fill_dir</p>\n<p>如果这次的输出和之前一样，那么请重新开始填坑。</p>\n<h2 id=\"计算径流量\"><a href=\"#计算径流量\" class=\"headerlink\" title=\"计算径流量\"></a>计算径流量</h2><p>flow accumulation<br>输入：fill_dir</p>\n<p>输出：accu</p>\n<h2 id=\"提取河网\"><a href=\"#提取河网\" class=\"headerlink\" title=\"提取河网\"></a>提取河网</h2><p>Spatial Analyst Tools-&gt;Map Algebra-&gt;Raster Calculator</p>\n<p>Con(accu&gt;X,1)<br>其中X为径流量，此值越大，河网越稀疏</p>\n<p>输出：河网</p>\n<h2 id=\"Stream-Link-amp-Stream-Order\"><a href=\"#Stream-Link-amp-Stream-Order\" class=\"headerlink\" title=\"Stream Link &amp;Stream Order\"></a>Stream Link &amp;Stream Order</h2><p>连接及分级</p>\n<h2 id=\"Stream-To-Feature\"><a href=\"#Stream-To-Feature\" class=\"headerlink\" title=\"Stream To Feature\"></a>Stream To Feature</h2><p>将河网转为Polyline<br>对河网分级设色：在矢量河网图层中的属性对话框中，Symbology-&gt;Quantities-&gt;Graduated colors.</p>\n<h2 id=\"流域提取\"><a href=\"#流域提取\" class=\"headerlink\" title=\"流域提取\"></a>流域提取</h2><p>使用watershed</p>\n<h2 id=\"Referenced\"><a href=\"#Referenced\" class=\"headerlink\" title=\"Referenced\"></a>Referenced</h2><p><a href=\"https://www.jianshu.com/p/371b81b3e24b\">1、简明Arcgis流域提取方法</a><br><a href=\"https://www.cnblogs.com/crazytao/p/8108829.html\">2、arcgis水文分析</a><br><a href=\"https://huadou145.lofter.com/post/205d4db3_1c81c6e8f\">3、封面图源</a></p>","categories":[{"name":"GIS","path":"api/categories/GIS.json"}],"tags":[{"name":"ArcGIS","path":"api/tags/ArcGIS.json"}]}