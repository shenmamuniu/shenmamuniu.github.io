{"title":"Python实现将Markdown转PDF","slug":"131","date":"2022-08-22T03:29:57.000Z","updated":"2022-08-22T03:29:57.000Z","comments":true,"path":"api/articles/131.json","excerpt":"由于Markdown在移动端读取稍微困难，因此存在将markdown文件转为PDF文档的需要。首先将markdown文件转为html,然后再用工具将html转为pdf文件。","covers":null,"content":"<p>由于Markdown在移动端读取稍微困难，因此存在将markdown文件转为PDF文档的需要。首先将markdown文件转为html,然后再用工具将html转为pdf文件。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"应用环境\"><a href=\"#应用环境\" class=\"headerlink\" title=\"应用环境\"></a>应用环境</h2><p>OS:windows<br>Python:3.9</p>\n<h2 id=\"文件遍历\"><a href=\"#文件遍历\" class=\"headerlink\" title=\"文件遍历\"></a>文件遍历</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\"># md文件路径\noriginal_path &#x3D; u&#39;xxx&#x2F;xxx&#39; \n# 输出路径\nsaved_path &#x3D; u&#39;xxx&#x2F;xxx&#39;\n\nfor root,dirs,files in os.walk(original_path):\n    # for dir in dirs:\n    #     print(os.path.join(root,dir))        \n    for file in files:\n        if file.endswith(&#39;md&#39;):\n            input&#x3D;os.path.join(root,file)\n            file &#x3D; file[:-2] + &#39;pdf&#39;\n            dirName&#x3D;&#39;&#39;\n            # 处理多级目录的情况\n            if root&#x3D;&#x3D;original_path:\n                dirName&#x3D;root.replace(original_path,&#39;&#39;)\n            else:\n                dirName&#x3D;root.replace(original_path+&#39;\\\\&#39;,&#39;&#39;)\n            # print(dirName)\n            dirOpt &#x3D; os.path.join(saved_path, dirName)\n            if not os.path.exists(dirOpt):\n                # 相比mkdir,此方法可创建多级目录\n                os.makedirs(dirOpt)\n            output&#x3D;os.path.join(dirOpt,file)\n\n            if not os.path.exists(output):\n                cvtMd2Pdf(input&#x3D;input,output&#x3D;output)\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"markdown转pdf\"><a href=\"#markdown转pdf\" class=\"headerlink\" title=\"markdown转pdf\"></a>markdown转pdf</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">import pdfkit\nfrom markdown import markdown\nimport os\n\ndef cvtMd2Pdf(input,output):\n    with open(input, encoding&#x3D;&#39;utf-8&#39;) as f:\n        text &#x3D; f.read()\n\n    html &#x3D; markdown(text, output_format&#x3D;&#39;html&#39;,extensions&#x3D;[&#39;tables&#39;])  # MarkDown转HTML\n    htmltopdf &#x3D; r&#39;C:\\\\Program Files\\\\wkhtmltopdf\\\\bin\\\\wkhtmltopdf.exe&#39;\n    configuration &#x3D; pdfkit.configuration(wkhtmltopdf&#x3D;htmltopdf)\n    pdfkit.from_string(html, output_path&#x3D;output, configuration&#x3D;configuration, options&#x3D;&#123;&#39;encoding&#39;: &#39;utf-8&#39;&#125;)  <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"缺点和不足\"><a href=\"#缺点和不足\" class=\"headerlink\" title=\"缺点和不足\"></a>缺点和不足</h2><p>1、存在某些文件转换失败的问题<br>2、转换效率不高</p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><p><a href=\"https://www.cnblogs.com/yibeimingyue/p/14678667.html?ivk_sa=1024320u\">1、python遍历某个文件夹下的所有子文件夹及文件</a><br><a href=\"https://www.jb51.net/article/231989.htm\">2、Python实战之markdown转pdf(包含公式转换)</a><br><a href=\"https://tiezhuzhuzhu923.lofter.com/post/310ff6d7_1c804cbfb\">3、封面图源</a></p>\n","more":"<h2 id=\"应用环境\"><a href=\"#应用环境\" class=\"headerlink\" title=\"应用环境\"></a>应用环境</h2><p>OS:windows<br>Python:3.9</p>\n<h2 id=\"文件遍历\"><a href=\"#文件遍历\" class=\"headerlink\" title=\"文件遍历\"></a>文件遍历</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\"># md文件路径\noriginal_path &#x3D; u&#39;xxx&#x2F;xxx&#39; \n# 输出路径\nsaved_path &#x3D; u&#39;xxx&#x2F;xxx&#39;\n\nfor root,dirs,files in os.walk(original_path):\n    # for dir in dirs:\n    #     print(os.path.join(root,dir))        \n    for file in files:\n        if file.endswith(&#39;md&#39;):\n            input&#x3D;os.path.join(root,file)\n            file &#x3D; file[:-2] + &#39;pdf&#39;\n            dirName&#x3D;&#39;&#39;\n            # 处理多级目录的情况\n            if root&#x3D;&#x3D;original_path:\n                dirName&#x3D;root.replace(original_path,&#39;&#39;)\n            else:\n                dirName&#x3D;root.replace(original_path+&#39;\\\\&#39;,&#39;&#39;)\n            # print(dirName)\n            dirOpt &#x3D; os.path.join(saved_path, dirName)\n            if not os.path.exists(dirOpt):\n                # 相比mkdir,此方法可创建多级目录\n                os.makedirs(dirOpt)\n            output&#x3D;os.path.join(dirOpt,file)\n\n            if not os.path.exists(output):\n                cvtMd2Pdf(input&#x3D;input,output&#x3D;output)\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"markdown转pdf\"><a href=\"#markdown转pdf\" class=\"headerlink\" title=\"markdown转pdf\"></a>markdown转pdf</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">import pdfkit\nfrom markdown import markdown\nimport os\n\ndef cvtMd2Pdf(input,output):\n    with open(input, encoding&#x3D;&#39;utf-8&#39;) as f:\n        text &#x3D; f.read()\n\n    html &#x3D; markdown(text, output_format&#x3D;&#39;html&#39;,extensions&#x3D;[&#39;tables&#39;])  # MarkDown转HTML\n    htmltopdf &#x3D; r&#39;C:\\\\Program Files\\\\wkhtmltopdf\\\\bin\\\\wkhtmltopdf.exe&#39;\n    configuration &#x3D; pdfkit.configuration(wkhtmltopdf&#x3D;htmltopdf)\n    pdfkit.from_string(html, output_path&#x3D;output, configuration&#x3D;configuration, options&#x3D;&#123;&#39;encoding&#39;: &#39;utf-8&#39;&#125;)  <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"缺点和不足\"><a href=\"#缺点和不足\" class=\"headerlink\" title=\"缺点和不足\"></a>缺点和不足</h2><p>1、存在某些文件转换失败的问题<br>2、转换效率不高</p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><p><a href=\"https://www.cnblogs.com/yibeimingyue/p/14678667.html?ivk_sa=1024320u\">1、python遍历某个文件夹下的所有子文件夹及文件</a><br><a href=\"https://www.jb51.net/article/231989.htm\">2、Python实战之markdown转pdf(包含公式转换)</a><br><a href=\"https://tiezhuzhuzhu923.lofter.com/post/310ff6d7_1c804cbfb\">3、封面图源</a></p>","categories":[{"name":"Python","path":"api/categories/Python.json"}],"tags":[{"name":"Python","path":"api/tags/Python.json"}]}