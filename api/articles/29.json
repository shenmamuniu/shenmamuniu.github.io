{"title":"PHP现学现卖系列之——我的博客归档页面12月怎么没数据啦","slug":"29","date":"2019-12-05T15:20:06.000Z","updated":"2019-12-05T15:20:06.000Z","comments":true,"path":"api/articles/29.json","excerpt":"进入12月份，发现博客归档页面的数据没有继续更新了，原来是日期的少了判断，接下来且看我在线表演PHP现学现卖[啊，不是—.—]","covers":null,"content":"<p>进入12月份，发现博客归档页面的数据没有继续更新了，原来是日期的少了判断，接下来且看我在线表演PHP现学现卖[啊，不是—.—]</p>\n<span id=\"more\"></span>\n<h2 id=\"归档页面\"><a href=\"#归档页面\" class=\"headerlink\" title=\"归档页面\"></a>归档页面</h2><p>原来的处理如下</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$year &#x3D; $archives-&gt;year;\n$month &#x3D; $archives-&gt;month;\n$nextMonth &#x3D; $archives-&gt;month+1;\n$contents &#x3D; $this-&gt;db-&gt;fetchAll($this-&gt;select()\n-&gt;where(&#39;table.contents.status &#x3D; ?&#39;, &#39;publish&#39;)\n-&gt;where(&#39;table.contents.created &gt;&#x3D; ?&#39;, strtotime(&quot;$year-$month&quot;))\n-&gt;where(&#39;table.contents.created &lt; ?&#39;, strtotime(&quot;$year-$nextMonth&quot;))\n-&gt;where(&#39;table.contents.type &#x3D; ?&#39;, &#39;post&#39;)\n-&gt;order(&#39;table.contents.created&#39;, Typecho_Db::SORT_DESC), array($this, &#39;push&#39;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>到12月时，这里忽略了年份的增加以及月份变为1月，故导致归档页面中的12月出现异常,接下来在这里添加判断就可以了。</p>\n<h2 id=\"PHP基本语法及typecho-post字段信息\"><a href=\"#PHP基本语法及typecho-post字段信息\" class=\"headerlink\" title=\"PHP基本语法及typecho post字段信息\"></a>PHP基本语法及typecho post字段信息</h2><h3 id=\"if-else的写法\"><a href=\"#if-else的写法\" class=\"headerlink\" title=\"if else的写法\"></a>if else的写法</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">if()&#123;\n&#125;\nelseif()&#123;\n&#125;\nelse&#123;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"等和不等\"><a href=\"#等和不等\" class=\"headerlink\" title=\"等和不等\"></a>等和不等</h3><p>&#x3D;&#x3D;和!&#x3D;即可</p>\n<h3 id=\"Widget-Contents-Post-Date字段解析\"><a href=\"#Widget-Contents-Post-Date字段解析\" class=\"headerlink\" title=\"Widget_Contents_Post_Date字段解析\"></a>Widget_Contents_Post_Date字段解析</h3><p>year：年份的字符串形式，譬如2015<br>month：月份的字符串形式，譬如01<br>day：字符串形式<br>示例如下：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#39;year&#39; &#x3D;&gt; string &#39;2015&#39; (length&#x3D;4)\n&#39;month&#39; &#x3D;&gt; string &#39;01&#39; (length&#x3D;2)\n&#39;day&#39; &#x3D;&gt; string &#39;25&#39; (length&#x3D;2)\n&#39;date&#39; &#x3D;&gt; string &#39;2015-01&#39; (length&#x3D;7)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"归档页面调整\"><a href=\"#归档页面调整\" class=\"headerlink\" title=\"归档页面调整\"></a>归档页面调整</h2><p>根据上面的信息，调整后的归档页面如下：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$year &#x3D; $archives-&gt;year;\n$month &#x3D; $archives-&gt;month;\n$nextMonth &#x3D; $archives-&gt;month+1;\n$nextYear&#x3D;$archives-&gt;year;\n\nif($archives-&gt;month &#x3D;&#x3D; &#39;12&#39;)&#123;\n$nextYear&#x3D;$archives-&gt;year+1;\n$nextMonth &#x3D; &#39;01&#39;;\n&#125;\n$contents &#x3D; $this-&gt;db-&gt;fetchAll($this-&gt;select()\n-&gt;where(&#39;table.contents.status &#x3D; ?&#39;, &#39;publish&#39;)\n-&gt;where(&#39;table.contents.created &gt;&#x3D; ?&#39;, strtotime(&quot;$year-$month&quot;))\n-&gt;where(&#39;table.contents.created &lt; ?&#39;, strtotime(&quot;$nextYear-$nextMonth&quot;))\n-&gt;where(&#39;table.contents.type &#x3D; ?&#39;, &#39;post&#39;)\n-&gt;order(&#39;table.contents.created&#39;, Typecho_Db::SORT_DESC), array($this, &#39;push&#39;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"Referenced\"><a href=\"#Referenced\" class=\"headerlink\" title=\"Referenced\"></a>Referenced</h2><p><a href=\"https://www.runoob.com/php/php-if-else.html\">1、PHP If…Else 语句</a><br><a href=\"https://www.typechodev.com/theme/55.html\">2、Typecho按时间归档</a><br><a href=\"https://huadou145.lofter.com/post/205d4db3_1c7247e32\">3、封面图</a></p>\n","more":"<h2 id=\"归档页面\"><a href=\"#归档页面\" class=\"headerlink\" title=\"归档页面\"></a>归档页面</h2><p>原来的处理如下</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$year &#x3D; $archives-&gt;year;\n$month &#x3D; $archives-&gt;month;\n$nextMonth &#x3D; $archives-&gt;month+1;\n$contents &#x3D; $this-&gt;db-&gt;fetchAll($this-&gt;select()\n-&gt;where(&#39;table.contents.status &#x3D; ?&#39;, &#39;publish&#39;)\n-&gt;where(&#39;table.contents.created &gt;&#x3D; ?&#39;, strtotime(&quot;$year-$month&quot;))\n-&gt;where(&#39;table.contents.created &lt; ?&#39;, strtotime(&quot;$year-$nextMonth&quot;))\n-&gt;where(&#39;table.contents.type &#x3D; ?&#39;, &#39;post&#39;)\n-&gt;order(&#39;table.contents.created&#39;, Typecho_Db::SORT_DESC), array($this, &#39;push&#39;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>到12月时，这里忽略了年份的增加以及月份变为1月，故导致归档页面中的12月出现异常,接下来在这里添加判断就可以了。</p>\n<h2 id=\"PHP基本语法及typecho-post字段信息\"><a href=\"#PHP基本语法及typecho-post字段信息\" class=\"headerlink\" title=\"PHP基本语法及typecho post字段信息\"></a>PHP基本语法及typecho post字段信息</h2><h3 id=\"if-else的写法\"><a href=\"#if-else的写法\" class=\"headerlink\" title=\"if else的写法\"></a>if else的写法</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">if()&#123;\n&#125;\nelseif()&#123;\n&#125;\nelse&#123;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"等和不等\"><a href=\"#等和不等\" class=\"headerlink\" title=\"等和不等\"></a>等和不等</h3><p>&#x3D;&#x3D;和!&#x3D;即可</p>\n<h3 id=\"Widget-Contents-Post-Date字段解析\"><a href=\"#Widget-Contents-Post-Date字段解析\" class=\"headerlink\" title=\"Widget_Contents_Post_Date字段解析\"></a>Widget_Contents_Post_Date字段解析</h3><p>year：年份的字符串形式，譬如2015<br>month：月份的字符串形式，譬如01<br>day：字符串形式<br>示例如下：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#39;year&#39; &#x3D;&gt; string &#39;2015&#39; (length&#x3D;4)\n&#39;month&#39; &#x3D;&gt; string &#39;01&#39; (length&#x3D;2)\n&#39;day&#39; &#x3D;&gt; string &#39;25&#39; (length&#x3D;2)\n&#39;date&#39; &#x3D;&gt; string &#39;2015-01&#39; (length&#x3D;7)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"归档页面调整\"><a href=\"#归档页面调整\" class=\"headerlink\" title=\"归档页面调整\"></a>归档页面调整</h2><p>根据上面的信息，调整后的归档页面如下：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$year &#x3D; $archives-&gt;year;\n$month &#x3D; $archives-&gt;month;\n$nextMonth &#x3D; $archives-&gt;month+1;\n$nextYear&#x3D;$archives-&gt;year;\n\nif($archives-&gt;month &#x3D;&#x3D; &#39;12&#39;)&#123;\n$nextYear&#x3D;$archives-&gt;year+1;\n$nextMonth &#x3D; &#39;01&#39;;\n&#125;\n$contents &#x3D; $this-&gt;db-&gt;fetchAll($this-&gt;select()\n-&gt;where(&#39;table.contents.status &#x3D; ?&#39;, &#39;publish&#39;)\n-&gt;where(&#39;table.contents.created &gt;&#x3D; ?&#39;, strtotime(&quot;$year-$month&quot;))\n-&gt;where(&#39;table.contents.created &lt; ?&#39;, strtotime(&quot;$nextYear-$nextMonth&quot;))\n-&gt;where(&#39;table.contents.type &#x3D; ?&#39;, &#39;post&#39;)\n-&gt;order(&#39;table.contents.created&#39;, Typecho_Db::SORT_DESC), array($this, &#39;push&#39;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"Referenced\"><a href=\"#Referenced\" class=\"headerlink\" title=\"Referenced\"></a>Referenced</h2><p><a href=\"https://www.runoob.com/php/php-if-else.html\">1、PHP If…Else 语句</a><br><a href=\"https://www.typechodev.com/theme/55.html\">2、Typecho按时间归档</a><br><a href=\"https://huadou145.lofter.com/post/205d4db3_1c7247e32\">3、封面图</a></p>","categories":[{"name":"Typecho","path":"api/categories/Typecho.json"}],"tags":[{"name":"typecho","path":"api/tags/typecho.json"},{"name":"PHP","path":"api/tags/PHP.json"}]}