{"title":"应用安全之隐藏Web服务器信息","slug":"87","date":"2021-04-01T09:34:00.000Z","updated":"2021-04-02T03:23:35.000Z","comments":true,"path":"api/articles/87.json","excerpt":"最近在漏洞扫描报告中提出了这样一个问题”可通过HTTP获取远端WWW服务信息”,本文对修复过程作记录。","covers":null,"content":"<p>最近在漏洞扫描报告中提出了这样一个问题”可通过HTTP获取远端WWW服务信息”,本文对修复过程作记录。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><p>OS:Asianux Server 4<br>Nginx:1.18.0</p>\n<h2 id=\"获取web服务器的信息\"><a href=\"#获取web服务器的信息\" class=\"headerlink\" title=\"获取web服务器的信息\"></a>获取web服务器的信息</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">curl -I ip:port<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>可以输入如下信息：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">HTTP&#x2F;1.1 200 OK\nServer: Nginx&#x2F;1.18.0\nDate: Thu, 01 Apr 2021 08:40:07 GMT\nContent-Type: text&#x2F;html\nContent-Length: 307\nLast-Modified: Wed, 12 Jun 2019 03:14:19 GMT\nConnection: keep-alive\nETag: &quot;5d006e0b-133&quot;\nAccept-Ranges: bytes<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"重新编译Nginx以屏蔽Nginx信息\"><a href=\"#重新编译Nginx以屏蔽Nginx信息\" class=\"headerlink\" title=\"重新编译Nginx以屏蔽Nginx信息\"></a>重新编译Nginx以屏蔽Nginx信息</h2><p>找到Nginx安装包中src&#x2F;http&#x2F;ngx_http_header_filter_module.c,修改以下内容：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static u_char ngx_http_server_string[] &#x3D; &quot;Server: unknown&quot; CRLF;\nstatic u_char ngx_http_server_full_string[] &#x3D; &quot;Server: unknown &quot; CRLF;\nstatic u_char ngx_http_server_build_string[] &#x3D; &quot;Server: unknown&quot; CRLF;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>重新编译安装nginx:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">.&#x2F;configure --without-http_rewrite_module --with-http_ssl_module\nmake\nmake install<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>运行Nginx后再次执行”curl -I ip:port” 就会发现nginx信息已被替换为unknown;</p>\n<p>对于win版本的Nginx，目前只找到如何隐藏版本号,在nginx配置文件中http节点下添加如下内容即可：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">server_tokens off;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"关于Tomcat\"><a href=\"#关于Tomcat\" class=\"headerlink\" title=\"关于Tomcat\"></a>关于Tomcat</h2><p>目前Tomcat的最新版本9.0.44中已经看不到这个信息，因此可以暂时忽略。</p>\n<h2 id=\"Referenced\"><a href=\"#Referenced\" class=\"headerlink\" title=\"Referenced\"></a>Referenced</h2><p><a href=\"https://blog.csdn.net/huangbaokang/article/details/88235386\">1、详细记录一次Tomcat服务器和Nginx服务器的缺省banner的修改全过程</a><br><a href=\"https://huadou145.lofter.com/post/205d4db3_1c84a2eba\">2.封面图源</a></p>\n","more":"<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><p>OS:Asianux Server 4<br>Nginx:1.18.0</p>\n<h2 id=\"获取web服务器的信息\"><a href=\"#获取web服务器的信息\" class=\"headerlink\" title=\"获取web服务器的信息\"></a>获取web服务器的信息</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">curl -I ip:port<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>可以输入如下信息：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">HTTP&#x2F;1.1 200 OK\nServer: Nginx&#x2F;1.18.0\nDate: Thu, 01 Apr 2021 08:40:07 GMT\nContent-Type: text&#x2F;html\nContent-Length: 307\nLast-Modified: Wed, 12 Jun 2019 03:14:19 GMT\nConnection: keep-alive\nETag: &quot;5d006e0b-133&quot;\nAccept-Ranges: bytes<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"重新编译Nginx以屏蔽Nginx信息\"><a href=\"#重新编译Nginx以屏蔽Nginx信息\" class=\"headerlink\" title=\"重新编译Nginx以屏蔽Nginx信息\"></a>重新编译Nginx以屏蔽Nginx信息</h2><p>找到Nginx安装包中src&#x2F;http&#x2F;ngx_http_header_filter_module.c,修改以下内容：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static u_char ngx_http_server_string[] &#x3D; &quot;Server: unknown&quot; CRLF;\nstatic u_char ngx_http_server_full_string[] &#x3D; &quot;Server: unknown &quot; CRLF;\nstatic u_char ngx_http_server_build_string[] &#x3D; &quot;Server: unknown&quot; CRLF;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>重新编译安装nginx:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">.&#x2F;configure --without-http_rewrite_module --with-http_ssl_module\nmake\nmake install<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>运行Nginx后再次执行”curl -I ip:port” 就会发现nginx信息已被替换为unknown;</p>\n<p>对于win版本的Nginx，目前只找到如何隐藏版本号,在nginx配置文件中http节点下添加如下内容即可：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">server_tokens off;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"关于Tomcat\"><a href=\"#关于Tomcat\" class=\"headerlink\" title=\"关于Tomcat\"></a>关于Tomcat</h2><p>目前Tomcat的最新版本9.0.44中已经看不到这个信息，因此可以暂时忽略。</p>\n<h2 id=\"Referenced\"><a href=\"#Referenced\" class=\"headerlink\" title=\"Referenced\"></a>Referenced</h2><p><a href=\"https://blog.csdn.net/huangbaokang/article/details/88235386\">1、详细记录一次Tomcat服务器和Nginx服务器的缺省banner的修改全过程</a><br><a href=\"https://huadou145.lofter.com/post/205d4db3_1c84a2eba\">2.封面图源</a></p>","categories":[{"name":"运维","path":"api/categories/运维.json"}],"tags":[{"name":"安全","path":"api/tags/安全.json"}]}